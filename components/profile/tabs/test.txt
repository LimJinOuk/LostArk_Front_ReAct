1. ì „íˆ¬ íƒ­: ì „íˆ¬ ì¥ë¹„, ì•…ì„¸ì‚¬ë¦¬ ui í¬ê¸° ì¤„ì´ê¸°
2. ì•„í¬ íŒ¨ì‹œë¸Œ íƒ­: ìƒí•˜ ui í¬ê¸° ì¤„ì´ê¸°
3. CharacterHeader ìƒí•˜ ui ì¤„ì´ê¸°

const EquipmentItem = ({
                           item, i, theme, tooltip, quality, reinforceLevel,
                           advancedReinforce, itemName, REINFORCE_OPTIONS,
                           setHoveredIndex, setHoveredData
                       }: EquipmentItemProps) => {

    const [localQuality, setLocalQuality] = useState(quality);
    const [localAdv, setLocalAdv] = useState(advancedReinforce);

    // ì´ˆê¸° ë¡œë“œ ì‹œ ë”± í•œ ë²ˆë§Œ ì‹¤í–‰ë˜ë„ë¡ í•¨ìˆ˜í˜• ì—…ë°ì´íŠ¸ ì‚¬ìš©
    const [selectedOption, setSelectedOption] = useState(() => {
        const level = reinforceLevel.replace('+', '');
        // í˜„ì¬ ì¥ë¹„ ìˆ˜ì¹˜ì™€ ì¼ì¹˜í•˜ëŠ” ì˜µì…˜ì„ ì°¾ë˜, ì—†ìœ¼ë©´ 4í‹°ì–´ ê¸°ë³¸ê°’
        return REINFORCE_OPTIONS.find(opt => String(opt.value) === level) || REINFORCE_OPTIONS[0];
    });

    // âš ï¸ [ìˆ˜ì • í¬ì¸íŠ¸] ì˜ì¡´ì„± ë°°ì—´ì—ì„œ REINFORCE_OPTIONSë¥¼ ì œê±°í•˜ê±°ë‚˜,
    // ë¶€ëª¨ë¡œë¶€í„° ë„˜ì–´ì˜¤ëŠ” ê°’ì´ ì‹¤ì œë¡œ 'ë³€ê²½'ë˜ì—ˆì„ ë•Œë§Œ ì´ˆê¸°í™”í•˜ë„ë¡ ì¡°ê±´ ì¶”ê°€
    useEffect(() => {
        const level = reinforceLevel.replace('+', '');
        const found = REINFORCE_OPTIONS.find(opt => String(opt.value) === level);

        // ì‚¬ìš©ìê°€ ì„ íƒí•œ ê°’ê³¼ ì„œë²„ì—ì„œ ì˜¨ ì´ˆê¸°ê°’ì´ ë‹¤ë¥¼ ë•Œë§Œ ë™ê¸°í™” (ìºë¦­í„° ê²€ìƒ‰ ì‹œ)
        if (found) {
            setLocalQuality(quality);
            setLocalAdv(advancedReinforce);
            setSelectedOption(found);
        }
        // eslint-disable-next-line react-hooks/exhaustive-deps
    }, [reinforceLevel, quality, advancedReinforce]);
    // ğŸ’¡ REINFORCE_OPTIONSë¥¼ ì˜ì¡´ì„±ì—ì„œ ì œì™¸í•˜ì—¬ ë¦¬ë Œë”ë§ ì‹œ ì´ˆê¸°í™”ë¥¼ ë°©ì§€í•©ë‹ˆë‹¤.

    const handleKeyDown = (e: any, type: string, value: any) => {
        if (e.key === 'Enter') e.currentTarget.blur();
    };

    return (
        <div
            onMouseEnter={() => { setHoveredIndex(i); setHoveredData(tooltip); }}
            onMouseLeave={() => { setHoveredIndex(null); setHoveredData(null); }}
            className="relative group flex items-center gap-3 p-2.5 rounded-xl hover:bg-white/[0.04] transition-colors h-[62px] cursor-help"
        >
            <div className="relative shrink-0">
                <div className={`p-0.5 rounded-lg border shadow-lg bg-gradient-to-br ${theme.bg} ${theme.border} ${theme.glow || ''}`}>
                    <img src={item.Icon} className="w-10 h-10 rounded-md object-cover bg-black/20" alt={itemName} />
                </div>
                <input
                    type="number"
                    min="0" max="100"
                    value={localQuality}
                    onChange={(e) => setLocalQuality(e.target.value)}
                    onKeyDown={(e) => handleKeyDown(e, 'í’ˆì§ˆ', localQuality)}
                    className={`absolute -bottom-1 -right-1 w-7 px-0.5 rounded-md text-[10px] font-black border border-zinc-700 bg-zinc-900 text-center focus:outline-none focus:ring-1 focus:ring-yellow-500
                    ${getQualityColor(Number(localQuality))} [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none transition-colors`}
                />
            </div>

            <div className="flex-1 min-w-0">
                <h3 className={`font-bold text-[12px] truncate mb-1 ${theme.text}`}>{itemName}</h3>
                <div className="flex items-center gap-2">
                    <select
                        className="bg-zinc-800 text-white/70 text-[10px] px-2 py-0.5 rounded border border-zinc-700 focus:outline-none focus:border-blue-500 appearance-none cursor-pointer scrollbar-hide"
                        value={`${selectedOption.tier}-${selectedOption.value}`}
                        onChange={(e) => {
                            const [tier, val] = e.target.value.split('-');
                            const found = REINFORCE_OPTIONS.find(opt => opt.tier === Number(tier) && opt.value === Number(val));
                            if (found) {
                                setSelectedOption(found); // ì—¬ê¸°ì„œ ìƒíƒœê°€ ë³€ê²½ë˜ë©´ ìœ„ useEffectëŠ” ì‹¤í–‰ë˜ì§€ ì•Šì•„ì•¼ í•¨
                            }
                        }}
                    >
                        {REINFORCE_OPTIONS.map(opt => (
                            <option
                                key={`${opt.tier}-${opt.value}`}
                                value={`${opt.tier}-${opt.value}`}
                                className="bg-zinc-900 text-white"
                            >
                                {opt.label}
                            </option>
                        ))}
                    </select>

                       <div className="flex items-center gap-1 bg-zinc-800 px-2 py-0.5 rounded border border-zinc-700 focus-within:border-sky-500 transition-colors">
                                            <span className="text-sky-400 text-[10px] font-bold">ìƒì¬</span>
                                            <input
                                                type="number"
                                                min="0" max="20"
                                                value={localAdv}
                                                onChange={(e) => setLocalAdv(e.target.value)}
                                                onKeyDown={(e) => handleKeyDown(e, 'ìƒì¬', localAdv)}
                                                className="w-5 bg-transparent text-sky-400 text-[10px] font-bold focus:outline-none [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none text-center"
                                            />
                                        </div>
                </div>
            </div>
        </div>
    );
};